(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{1301:(e,t,a)=>{Promise.resolve().then(a.bind(a,3038))},2801:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>o,c:()=>l});var s=a(5155),r=a(2115);let l=(0,r.createContext)();function o(e){let{children:t}=e,[a,o]=(0,r.useState)(null),[n,u]=(0,r.useState)(null),[i,d]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");e&&o(e),t&&u(JSON.parse(t)),d(!1)},[]),(0,s.jsx)(l.Provider,{value:{token:a,user:n,login:(e,t)=>{localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(t)),o(e),u(t)},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),o(null),u(null)},loading:i},children:t})}},3038:(e,t,a)=>{"use strict";a.d(t,{default:()=>n});var s=a(5155),r=a(2115),l=a(5695),o=a(2801);function n(){let e=(0,l.useRouter)(),{login:t}=(0,r.useContext)(o.c),[a,n]=(0,r.useState)(""),[u,i]=(0,r.useState)(""),[d,m]=(0,r.useState)({}),[c,g]=(0,r.useState)(!1),[h,b]=(0,r.useState)(""),p=async s=>{if(s.preventDefault(),m({}),b(""),!/\S+@\S+\.\S+/.test(a))return void m({email:"Enter a valid email."});if(u.length<3)return void m({password:"Password must be at least 3 characters."});g(!0);try{let s=await fetch("https://nutrijoy-backend.onrender.com/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:u})}),r=await s.json();s.ok?(b("Login successful!"),t(r.token,r.user),setTimeout(()=>{"admin"===r.user.role?e.push("/admin"):e.push("/dashboard")},800)):m({form:r.message||"Login failed."})}catch(e){m({form:"Something went wrong."})}finally{g(!1)}};return(0,s.jsxs)("form",{onSubmit:p,className:"max-w-lg mx-auto bg-white p-10 rounded-lg shadow-lg",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold mb-8 text-center text-green-900",children:"Login"}),h&&(0,s.jsx)("p",{className:"text-green-600 text-center mb-4",children:h}),d.form&&(0,s.jsx)("p",{className:"text-red-600 text-center mb-4",children:d.form}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"email",className:"block font-semibold mb-1",children:"Email"}),(0,s.jsx)("input",{type:"email",id:"email",value:a,onChange:e=>n(e.target.value),className:"w-full px-4 py-3 border rounded-lg ".concat(d.email?"border-red-500":"border-gray-300")}),d.email&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:d.email})]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("label",{htmlFor:"password",className:"block font-semibold mb-1",children:"Password"}),(0,s.jsx)("input",{type:"password",id:"password",value:u,onChange:e=>i(e.target.value),className:"w-full px-4 py-3 border rounded-lg ".concat(d.password?"border-red-500":"border-gray-300")}),d.password&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:d.password})]}),(0,s.jsx)("button",{type:"submit",disabled:c,className:"w-full bg-green-700 hover:bg-green-800 text-white font-semibold py-3 rounded-lg text-lg transition disabled:opacity-50",children:c?"Logging in...":"Login"})]})}},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})}},e=>{e.O(0,[441,964,358],()=>e(e.s=1301)),_N_E=e.O()}]);