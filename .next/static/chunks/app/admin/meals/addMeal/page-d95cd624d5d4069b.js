(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[134],{1576:(e,a,t)=>{Promise.resolve().then(t.bind(t,5287))},5287:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>n});var l=t(5155),s=t(2115),r=t(5695);function n(){(0,r.useRouter)();let e=(0,r.useSearchParams)().get("id"),[a,t]=(0,s.useState)(""),[n,o]=(0,s.useState)("fried"),[i,u]=(0,s.useState)(""),[d,c]=(0,s.useState)("g"),[m,h]=(0,s.useState)(""),[p,g]=(0,s.useState)(null),[b,j]=(0,s.useState)(""),[f,x]=(0,s.useState)(!1),[v,y]=(0,s.useState)("");(0,s.useEffect)(()=>{if(e){let a=localStorage.getItem("token");fetch("https://nutrijoy-backend.onrender.com/api/meals/getMeal/".concat(e),{headers:{Authorization:"Bearer ".concat(a)}}).then(e=>e.json()).then(e=>{t(e.name||""),o(e.category||"fried"),u(e.baseQuantityValue||""),c(e.baseQuantityUnit||"g"),h(e.caloriesPerBase||""),j(e.imageUrl||"")}).catch(()=>y("Failed to fetch meal data"))}},[e]);let k=async l=>{if(l.preventDefault(),y(""),!a||!n||!i||!d||!m||!p&&!b)return void y("Please fill all fields and select an image.");x(!0);try{let s,r=b;if(p){let e=new FormData;e.append("image",p);let a=await fetch("https://nutrijoy-backend.onrender.com/api/upload",{method:"POST",body:e});if(!a.ok)throw Error("Image upload failed");r=(await a.json()).imageUrl}let f=localStorage.getItem("token"),x={name:a.trim(),category:n,baseQuantityValue:Number(i),baseQuantityUnit:d,caloriesPerBase:Number(m),imageUrl:r};if(!(s=e?await fetch("https://nutrijoy-backend.onrender.com/api/meals/updateMeal/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(f)},body:JSON.stringify(x)}):await fetch("https://nutrijoy-backend.onrender.com/api/meals/addMeal",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(f)},body:JSON.stringify(x)})).ok){let e=await s.json();throw Error(e.message||"Failed to save meal")}y(e?"Meal updated successfully!":"Meal added successfully!"),e||(t(""),o("fried"),u(""),c("g"),h(""),g(null),j(""),l.target.reset())}catch(e){y(e.message||"Something went wrong")}finally{x(!1)}};return(0,l.jsxs)("form",{onSubmit:k,className:"max-w-md mx-auto p-6 bg-white rounded shadow",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-6",children:e?"Edit Meal":"Add Meal"}),(0,l.jsxs)("label",{className:"block mb-4",children:["Name",(0,l.jsx)("input",{type:"text",value:a,onChange:e=>t(e.target.value),className:"w-full border rounded p-2 mt-1",required:!0})]}),(0,l.jsxs)("label",{className:"block mb-4",children:["Category",(0,l.jsxs)("select",{value:n,onChange:e=>o(e.target.value),className:"w-full border rounded p-2 mt-1",required:!0,children:[(0,l.jsx)("option",{value:"fried",children:"Fried"}),(0,l.jsx)("option",{value:"baked",children:"Baked"}),(0,l.jsx)("option",{value:"legumes",children:"Legumes"}),(0,l.jsx)("option",{value:"snacks",children:"Snacks"}),(0,l.jsx)("option",{value:"desserts",children:"Desserts"}),(0,l.jsx)("option",{value:"grilled",children:"Grilled"}),(0,l.jsx)("option",{value:"salads",children:"Salads"}),(0,l.jsx)("option",{value:"soups",children:"Soups"}),(0,l.jsx)("option",{value:"beverages",children:"Beverages"}),(0,l.jsx)("option",{value:"others",children:"Others"})]})]}),(0,l.jsxs)("label",{className:"block mb-4",children:["Base Quantity",(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{type:"number",value:i,onChange:e=>u(e.target.value),placeholder:"e.g., 100",className:"w-1/2 border rounded p-2 mt-1",min:1,required:!0}),(0,l.jsxs)("select",{value:d,onChange:e=>c(e.target.value),className:"w-1/2 border rounded p-2 mt-1",required:!0,children:[(0,l.jsx)("option",{value:"g",children:"grams (g)"}),(0,l.jsx)("option",{value:"kg",children:"kilograms (kg)"}),(0,l.jsx)("option",{value:"piece",children:"piece"}),(0,l.jsx)("option",{value:"slice",children:"slice"}),(0,l.jsx)("option",{value:"cup",children:"cup"}),(0,l.jsx)("option",{value:"ml",children:"milliliters (ml)"}),(0,l.jsx)("option",{value:"l",children:"liters (l)"})]})]})]}),(0,l.jsxs)("label",{className:"block mb-4",children:["Calories per Base",(0,l.jsx)("input",{type:"number",value:m,onChange:e=>h(e.target.value),placeholder:"e.g., 208",className:"w-full border rounded p-2 mt-1",min:0,required:!0})]}),(0,l.jsxs)("label",{className:"block mb-4",children:["Image",(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{g(e.target.files[0])},className:"w-full mt-1"}),b&&(0,l.jsx)("img",{src:"https://nutrijoy-backend.onrender.com".concat(b),alt:"Meal",className:"mt-2 w-24 h-24 object-cover rounded"})]}),(0,l.jsx)("button",{type:"submit",disabled:f,className:"w-full bg-green-700 text-white py-2 rounded hover:bg-green-800 transition",children:f?e?"Updating...":"Uploading...":e?"Update Meal":"Add Meal"}),v&&(0,l.jsx)("p",{className:"mt-4 text-center",children:v})]})}},5695:(e,a,t)=>{"use strict";var l=t(8999);t.o(l,"usePathname")&&t.d(a,{usePathname:function(){return l.usePathname}}),t.o(l,"useRouter")&&t.d(a,{useRouter:function(){return l.useRouter}}),t.o(l,"useSearchParams")&&t.d(a,{useSearchParams:function(){return l.useSearchParams}})}},e=>{e.O(0,[441,964,358],()=>e(e.s=1576)),_N_E=e.O()}]);