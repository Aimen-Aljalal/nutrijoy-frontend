(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[903],{4848:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(5155),s=r(2115),n=r(5695);function o(){let e=(0,n.useRouter)(),[t,r]=(0,s.useState)([]),[o,i]=(0,s.useState)(null),[l,c]=(0,s.useState)(!0);if((0,s.useEffect)(()=>{(async()=>{let t=localStorage.getItem("token");if(!t)return e.push("/login");try{let e=await fetch("https://nutrijoy-backend.onrender.com/api/user/profile",{headers:{Authorization:"Bearer ".concat(t)}});if(!e.ok)throw Error("Failed to fetch user");let a=await e.json();i(a);let s=await fetch("https://nutrijoy-backend.onrender.com/api/dailyConsumption/history",{headers:{Authorization:"Bearer ".concat(t)}});if(!s.ok)throw Error("Failed to fetch history");let n=await s.json();r(n)}catch(e){console.error(e)}finally{c(!1)}})()},[e]),l)return(0,a.jsx)("p",{children:"Loading history..."});let u=(e=>{var t,r,a;if(!e)return 0;let s=Number(e.weight_kg),n=Number(e.height_cm),o=Number(e.age),i=null==(t=e.gender)?void 0:t.toLowerCase(),l=(null==(r=e.activity_level)?void 0:r.toLowerCase())||"sedentary",c=0;"male"===i?c=10*s+6.25*n-5*o+5:"female"===i&&(c=10*s+6.25*n-5*o-161);let u=1.2;"light"===l?u=1.375:"moderate"===l?u=1.55:"active"===l?u=1.725:"very active"===l&&(u=1.9);let h=c*u,d=(null==(a=e.goal)?void 0:a.toLowerCase())||"maintain weight";return"lose weight"===d?h*=.8:"gain weight"===d&&(h*=1.2),Math.round(h)})(o);return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"History"}),0===t.length&&(0,a.jsx)("p",{children:"No records found."}),t.map(e=>{let t=u-e.totalCalories;return(0,a.jsxs)("div",{className:"mb-4 p-4 bg-gray-100 rounded-lg shadow",children:[(0,a.jsx)("h2",{className:"font-semibold mb-2",children:new Date(e.date).toLocaleDateString("en-GB")}),(0,a.jsx)("ul",{className:"mb-2",children:e.meals.map(e=>(0,a.jsx)("li",{className:"flex justify-between",children:(0,a.jsxs)("span",{children:[e.name||e.customName," - ",e.calories," kcal"]})},e._id))}),(0,a.jsxs)("p",{className:"font-semibold text-".concat(t>=0?"green":"red","-600"),children:["Remaining:"," ",(0,a.jsxs)("span",{style:{color:t>=0?"green":"red"},children:[t," kcal"]})]})]},e._id)})]})}},5162:(e,t,r)=>{Promise.resolve().then(r.bind(r,4848))},5695:(e,t,r)=>{"use strict";var a=r(8999);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})}},e=>{e.O(0,[441,964,358],()=>e(e.s=5162)),_N_E=e.O()}]);