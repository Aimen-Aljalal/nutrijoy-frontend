(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[926],{2801:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>n,c:()=>l});var r=a(5155),s=a(2115);let l=(0,s.createContext)();function n(e){let{children:t}=e,[a,n]=(0,s.useState)(null),[o,i]=(0,s.useState)(null),[u,c]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");e&&n(e),t&&i(JSON.parse(t)),c(!1)},[]),(0,r.jsx)(l.Provider,{value:{token:a,user:o,login:(e,t)=>{localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(t)),n(e),i(t)},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),n(null),i(null)},loading:u},children:t})}},5265:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var r=a(5155),s=a(2115),l=a(5695),n=a(2801);function o(){let{logout:e}=(0,s.useContext)(n.c),[t,a]=(0,s.useState)(null),[o,i]=(0,s.useState)(!0),[u,c]=(0,s.useState)(!1),d=(0,l.useRouter)(),m=localStorage.getItem("token");(0,s.useEffect)(()=>{if(!m)return void d.push("/");(async()=>{try{let t=await fetch("https://nutrijoy-backend.onrender.com/api/user/profile",{headers:{Authorization:"Bearer ".concat(m)}});if(!t.ok){e(),d.push("/");return}let r=await t.json();a(r)}catch(t){console.error(t),e(),d.push("/login")}finally{i(!1)}})()},[d,e,m]);let g=e=>{a({...t,[e.target.name]:e.target.value})},h=async e=>{e.preventDefault(),c(!0);try{let e=await fetch("https://nutrijoy-backend.onrender.com/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m)},body:JSON.stringify({username:t.username,email:t.email,weight_kg:Number(t.weight_kg),height_cm:Number(t.height_cm),age:Number(t.age)})}),a=await e.json();if(!e.ok)return void alert(a.message||"Update failed");alert("Profile updated successfully!"),d.push("/dashboard")}catch(e){console.error(e),alert("Something went wrong")}finally{c(!1)}};return o?(0,r.jsx)("div",{className:"flex justify-center items-center min-h-screen bg-gray-50",children:(0,r.jsx)("p",{className:"text-lg text-gray-600",children:"Loading profile..."})}):t?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("header",{className:"bg-gradient-to-r from-green-700 to-green-900 shadow-lg py-4 px-6 flex justify-between items-center",children:(0,r.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Edit Profile"})}),(0,r.jsx)("main",{className:"max-w-3xl mx-auto p-6",children:(0,r.jsxs)("form",{onSubmit:h,className:"bg-white rounded-xl shadow-lg p-6 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Username"}),(0,r.jsx)("input",{type:"text",name:"username",value:t.username,onChange:g,className:"w-full border rounded-lg p-2",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Email"}),(0,r.jsx)("input",{type:"email",name:"email",value:t.email,onChange:g,className:"w-full border rounded-lg p-2",required:!0})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Age"}),(0,r.jsx)("input",{type:"number",name:"age",value:t.age,onChange:g,className:"w-full border rounded-lg p-2",min:"10",max:"100",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Height (cm)"}),(0,r.jsx)("input",{type:"number",name:"height_cm",value:t.height_cm,onChange:g,className:"w-full border rounded-lg p-2",min:"100",max:"250",required:!0})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Weight (kg)"}),(0,r.jsx)("input",{type:"number",name:"weight_kg",value:t.weight_kg,onChange:g,className:"w-full border rounded-lg p-2",min:"30",max:"300",required:!0})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>d.push("/dashboard"),className:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-lg shadow",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:u,className:"bg-green-700 hover:bg-green-800 text-white font-semibold py-2 px-4 rounded-lg shadow",children:u?"Saving...":"Save Changes"})]})]})})]}):null}},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},8181:(e,t,a)=>{Promise.resolve().then(a.bind(a,5265))}},e=>{e.O(0,[441,964,358],()=>e(e.s=8181)),_N_E=e.O()}]);