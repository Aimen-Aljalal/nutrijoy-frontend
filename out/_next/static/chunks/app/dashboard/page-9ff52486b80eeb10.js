(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{2801:(e,s,t)=>{"use strict";t.d(s,{AuthProvider:()=>n,c:()=>r});var a=t(5155),l=t(2115);let r=(0,l.createContext)();function n(e){let{children:s}=e,[t,n]=(0,l.useState)(null),[i,o]=(0,l.useState)(null),[c,d]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{let e=localStorage.getItem("token"),s=localStorage.getItem("user");e&&n(e),s&&o(JSON.parse(s)),d(!1)},[]),(0,a.jsx)(r.Provider,{value:{token:t,user:i,login:(e,s)=>{localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(s)),n(e),o(s)},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),n(null),o(null)},loading:c},children:s})}},5695:(e,s,t)=>{"use strict";var a=t(8999);t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},5947:(e,s,t)=>{Promise.resolve().then(t.bind(t,8422))},8422:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var a=t(5155),l=t(2115),r=t(5695),n=t(2801);function i(){var e;let{logout:s}=(0,l.useContext)(n.c),[t,i]=(0,l.useState)(null),[o,c]=(0,l.useState)(!0),[d,m]=(0,l.useState)(!1),[g,h]=(0,l.useState)({}),u=(0,r.useRouter)();(0,l.useEffect)(()=>{let e=localStorage.getItem("token");if(!e)return void u.push("/");(async()=>{try{let t=await fetch("https://nutrijoy-backend.onrender.com/api/user/profile",{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok){s(),u.push("/");return}let a=await t.json();i(a),h(a)}catch(e){console.error(e),s(),u.push("/login")}finally{c(!1)}})()},[u,s]);let x=e=>{h({...g,[e.target.name]:e.target.value})},p=async()=>{let e=localStorage.getItem("token");try{let s=await fetch("https://nutrijoy-backend.onrender.com/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({username:g.username,email:g.email,age:g.age,weight_kg:g.weight_kg})}),t=await s.json();s.ok?(i(t.user),m(!1)):alert(t.message||"Update failed")}catch(e){console.error(e),alert("Something went wrong.")}};if(o)return(0,a.jsx)("div",{className:"flex justify-center items-center min-h-screen bg-gray-50",children:(0,a.jsx)("p",{className:"text-lg text-gray-600",children:"Loading dashboard..."})});if(!t)return null;let b=[0,18,25,30,35,40],f=e=>e/40*100,j=b.map(f),N=f(Math.max(0,Math.min(Number(null!=(e=t.bmi)?e:0),40)));return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsxs)("header",{className:"bg-gradient-to-r from-green-700 to-green-900 shadow-lg py-4 px-6 flex justify-between items-center",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-white",children:["Welcome, ",(0,a.jsx)("span",{className:"text-yellow-200",children:t.username})]}),(0,a.jsx)("button",{onClick:()=>u.push("/dashboard/edit"),className:"bg-yellow-400 hover:bg-yellow-500 text-green-900 font-semibold py-2 px-4 rounded-lg shadow",children:"Edit Profile"})]}),(0,a.jsxs)("main",{className:"max-w-5xl mx-auto p-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-green-800 mb-4",children:"Your Profile"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 text-gray-700",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold text-green-700",children:"Username:"})," ",t.username]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold text-green-700",children:"Email:"})," ",t.email]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold text-green-700",children:"Age:"})," ",t.age]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold text-green-700",children:"Gender:"})," ",t.gender]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold text-green-700",children:"Height:"})," ",t.height_cm," cm"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold text-green-700",children:"Weight:"})," ",t.weight_kg," kg"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold text-green-700",children:"Ideal Weight:"})," ",t.idealWeight," kg"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold text-green-700",children:"BMI:"})," ",t.bmi," (",t.bmiCategory,")"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold text-green-700",children:"Activity Level:"})," ",t.activity_level]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold text-green-700",children:"Goal:"})," ",t.goal]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-semibold text-green-700",children:"Daily Calories:"})," ",(e=>{var s,t,a;if(!e)return 0;let l=Number(e.weight_kg),r=Number(e.height_cm),n=Number(e.age),i=null==(s=e.gender)?void 0:s.toLowerCase(),o=(null==(t=e.activity_level)?void 0:t.toLowerCase())||"sedentary",c=0;"male"===i?c=10*l+6.25*r-5*n+5:"female"===i&&(c=10*l+6.25*r-5*n-161);let d=1.2;"light"===o?d=1.375:"moderate"===o?d=1.55:"active"===o?d=1.725:"very active"===o&&(d=1.9);let m=c*d,g=(null==(a=e.goal)?void 0:a.toLowerCase())||"maintain weight";return"lose weight"===g?m*=.8:"gain weight"===g&&(m*=1.2),Math.round(m)})(t)," kcal"]})]})]}),(0,a.jsxs)("div",{className:"mt-10 bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-green-800 mb-4",children:"BMI Meter"}),(0,a.jsxs)("div",{className:"relative w-full h-8 rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"absolute inset-0 flex",children:[(0,a.jsx)("div",{className:"bg-blue-400 h-full",style:{flex:18}}),(0,a.jsx)("div",{className:"bg-green-400 h-full",style:{flex:7}}),(0,a.jsx)("div",{className:"bg-yellow-400 h-full",style:{flex:5}}),(0,a.jsx)("div",{className:"bg-orange-400 h-full",style:{flex:5}}),(0,a.jsx)("div",{className:"bg-red-500 h-full",style:{flex:5}})]}),j.slice(1,-1).map((e,s)=>(0,a.jsx)("div",{className:"absolute top-0 bottom-0 w-px bg-white/70",style:{left:"".concat(e,"%")}},"tickline-".concat(s))),(0,a.jsx)("div",{className:"absolute -top-12 font-extrabold drop-shadow-lg",style:{left:"".concat(N,"%"),transform:"translateX(-50%)",fontSize:"4rem",color:"black"},children:"↑"})]}),(0,a.jsx)("div",{className:"relative w-full mt-3 h-6",children:b.map((e,s)=>(0,a.jsx)("span",{className:"absolute text-sm text-gray-700",style:{left:"".concat(j[s],"%"),transform:"translateX(-50%)"},children:s===b.length-1?"40+":e},"tick-".concat(e)))}),(0,a.jsxs)("p",{className:"mt-6 text-center text-gray-700",children:["Your BMI:"," ",(0,a.jsx)("span",{className:"font-bold text-green-800",children:t.bmi})," (",t.bmiCategory,")"]}),(0,a.jsxs)("div",{className:"mt-2 text-center text-xs text-gray-500",children:[(0,a.jsx)("span",{className:"mr-3",children:"Underweight: 0–18"}),(0,a.jsx)("span",{className:"mr-3",children:"Normal: 18–25"}),(0,a.jsx)("span",{className:"mr-3",children:"Overweight: 25–30"}),(0,a.jsx)("span",{className:"mr-3",children:"Obesity I: 30–35"}),(0,a.jsx)("span",{children:"Obesity II: 35+"})]})]})]}),d&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg w-full max-w-md",children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-4 text-green-800",children:"Edit Profile"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("input",{type:"text",name:"username",value:g.username||"",onChange:x,placeholder:"Username",className:"w-full border border-gray-300 rounded-lg p-2"}),(0,a.jsx)("input",{type:"email",name:"email",value:g.email||"",onChange:x,placeholder:"Email",className:"w-full border border-gray-300 rounded-lg p-2"}),(0,a.jsx)("input",{type:"number",name:"age",value:g.age||"",onChange:x,placeholder:"Age",className:"w-full border border-gray-300 rounded-lg p-2"}),(0,a.jsx)("input",{type:"number",name:"weight_kg",value:g.weight_kg||"",onChange:x,placeholder:"Weight (kg)",className:"w-full border border-gray-300 rounded-lg p-2"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 mt-4",children:[(0,a.jsx)("button",{onClick:()=>m(!1),className:"px-4 py-2 rounded-lg border border-gray-300 text-gray-600 hover:bg-gray-100",children:"Cancel"}),(0,a.jsx)("button",{onClick:p,className:"px-4 py-2 rounded-lg bg-green-700 text-white hover:bg-green-800",children:"Save"})]})]})})]})}}},e=>{e.O(0,[441,964,358],()=>e(e.s=5947)),_N_E=e.O()}]);