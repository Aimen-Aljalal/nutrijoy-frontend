(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{1356:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var s=a(5155),l=a(2115),r=a(5695),n=a(3491);function i(){let e=(0,r.useRouter)(),[t,a]=(0,l.useState)([]),[i,c]=(0,l.useState)(!0),[d,o]=(0,l.useState)(""),[h,u]=(0,l.useState)(null),m=()=>localStorage.getItem("token"),x=async()=>{c(!0),o("");try{let t=m();if(!t)return void e.push("/login");let s=await fetch("https://nutrijoy-backend.onrender.com/api/meals/getAllMeals",{headers:{Authorization:"Bearer ".concat(t)}}),l=await s.json();if(401===s.status||403===s.status)return void e.push("/login");if(s.ok){let e=Array.isArray(l)?l:l.meals||[];a(e)}else 404===s.status&&l.message?a([]):o(l.message||"Failed to load meals")}catch(e){o("Failed to load meals")}finally{c(!1)}};(0,l.useEffect)(()=>{x()},[]);let p=async e=>{if(confirm("Are you sure you want to delete this meal?"))try{u(e);let t=m(),s=await fetch("https://nutrijoy-backend.onrender.com/api/meals/deleteMeal/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),l=await s.json();if(!s.ok)throw Error(l.message||"Delete failed");a(t=>t.filter(t=>t._id!==e))}catch(e){alert(e.message)}finally{u(null)}};return i?(0,s.jsx)("p",{children:"Loading meals..."}):(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Manage Meals"}),(0,s.jsx)("button",{onClick:()=>e.push("/admin/meals/addMeal"),className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition",children:"Add Meal"})]}),d&&(0,s.jsx)("p",{className:"text-red-600 mb-4",children:d}),0===t.length?(0,s.jsx)("p",{className:"text-gray-500",children:"No meals right now"}):(0,s.jsxs)("table",{className:"w-full bg-white rounded shadow",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-100",children:[(0,s.jsx)("th",{className:"p-3 text-left",children:"Image"}),(0,s.jsx)("th",{className:"p-3 text-left",children:"Name"}),(0,s.jsx)("th",{className:"p-3 text-left",children:"Category"}),(0,s.jsx)("th",{className:"p-3 text-left",children:"Base Quantity"}),(0,s.jsx)("th",{className:"p-3 text-left",children:"Calories per Base"}),(0,s.jsx)("th",{className:"p-3 text-left",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:t.map(t=>(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"p-3",children:(0,s.jsx)("img",{src:(0,n.V)(t.imageUrl),alt:t.name,className:"w-16 h-16 object-cover rounded"})}),(0,s.jsx)("td",{className:"p-3",children:t.name}),(0,s.jsx)("td",{className:"p-3",children:t.category}),(0,s.jsx)("td",{className:"p-3",children:t.baseQuantityValue&&t.baseQuantityUnit?"".concat(t.baseQuantityValue," ").concat(t.baseQuantityUnit):"-"}),(0,s.jsx)("td",{className:"p-3",children:null!=t.caloriesPerBase?"".concat(t.caloriesPerBase," kcal"):"-"}),(0,s.jsxs)("td",{className:"p-3 flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>e.push("/admin/meals/addMeal?id=".concat(t._id)),className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>p(t._id),disabled:h===t._id,className:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition",children:h===t._id?"Deleting...":"Delete"})]})]},t._id))})]})]})}},3248:(e,t,a)=>{Promise.resolve().then(a.bind(a,1356))},3491:(e,t,a)=>{"use strict";a.d(t,{V:()=>s});let s=e=>e?e.startsWith("http")?e:"https://nutrijoy-backend.onrender.com".concat(e):"/placeholder.png"},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})}},e=>{e.O(0,[441,964,358],()=>e(e.s=3248)),_N_E=e.O()}]);